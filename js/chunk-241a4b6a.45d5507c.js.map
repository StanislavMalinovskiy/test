{"version":3,"sources":["webpack:///./src/views/Login.vue?5069","webpack:///src/views/Login.vue","webpack:///./src/views/Login.vue?5da6","webpack:///./src/views/Login.vue","webpack:///./src/assets/google-play-badge.png"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","ref","staticStyle","staticRenderFns","component","module","exports"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,cAAc,CAACE,YAAY,oBAAoBC,MAAM,CAAC,MAAQ,KAAK,CAACH,EAAG,QAAQ,CAACE,YAAY,QAAQC,MAAM,CAAC,MAAQ,SAAS,QAAU,WAAW,CAACH,EAAG,QAAQ,CAACG,MAAM,CAAC,aAAa,SAAS,KAAO,KAAK,GAAK,OAAO,CAAEP,EAAW,QAAEI,EAAG,KAAK,CAACG,MAAM,CAAC,MAAQ,WAAW,CAACP,EAAIQ,GAAG,aAAaJ,EAAG,KAAK,CAACG,MAAM,CAAC,MAAQ,WAAW,CAACP,EAAIQ,GAAG,4BAA4BJ,EAAG,QAAQ,CAACG,MAAM,CAAC,aAAa,SAAS,KAAO,KAAK,GAAK,IAAI,GAAK,IAAI,GAAK,MAAM,CAACH,EAAG,SAAS,GAAG,CAACA,EAAG,cAAc,CAACE,YAAY,yBAAyBC,MAAM,CAAC,MAAQ,SAAS,KAAO,KAAK,CAACH,EAAG,QAAQ,CAACG,MAAM,CAAC,MAAQ,SAAS,QAAU,WAAW,CAACH,EAAG,QAAQ,CAACG,MAAM,CAAC,KAAO,KAAK,GAAK,OAAO,CAACH,EAAG,UAAU,CAACJ,EAAIQ,GAAG,wFAAwF,GAAGJ,EAAG,QAAQ,CAACG,MAAM,CAAC,KAAO,KAAK,GAAK,OAAO,CAACH,EAAG,UAAU,CAACJ,EAAIQ,GAAG,uEAAuE,GAAGJ,EAAG,QAAQ,CAACG,MAAM,CAAC,KAAO,KAAK,GAAK,OAAO,CAACH,EAAG,UAAU,CAACJ,EAAIQ,GAAG,uDAAuD,IAAI,IAAI,GAAGJ,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQ,WAAW,CAACH,EAAG,MAAM,CAACK,IAAI,aAAaC,YAAY,CAAC,OAAS,YAAYN,EAAG,iBAAiB,CAACE,YAAY,QAAQ,CAACF,EAAG,YAAYA,EAAG,KAAK,CAACJ,EAAIQ,GAAG,sBAAsBJ,EAAG,MAAM,CAACG,MAAM,CAAC,IAAM,EAAQ,QAAmC,MAAQ,QAAQ,OAAS,UAAUH,EAAG,aAAa,IAAI,IAAI,IAAI,IAAI,IACj7CO,EAAkB,G,4DCiEtB,GACE,KAAF,QAEE,KAAF,WAAI,MAAJ,CACM,SAAN,IAEE,QANF,WAOA,mCACM,KAAN,4CAEI,KAAJ,2BACI,KAAJ,WACI,KAAJ,YAEE,QAAF,CACI,SADJ,aAII,yBAJJ,WAMM,IAAN,mCACM,EAAN,SACM,EAAN,mDACM,EAAN,kCAEM,EAAN,oDACM,EAAN,mDACM,EAAN,4CAEM,KAAN,gCAEM,OAAN,oCAEI,eAnBJ,SAmBA,GAGM,IAAN,YAEA,EACA,oBAIU,KAAV,2BAHU,KAAV,eACU,KAAV,kBAKQ,KAAR,2BAGI,YAnCJ,SAmCA,GAAM,IAAN,OAEM,KAAN,kCACA,iBAEQ,EAAR,2CAGI,cA3CJ,SA2CA,GAAM,IAAN,OAAM,OAAN,qDAAQ,OAAR,qCAAU,MAAV,EAAY,OAAZ,sCAEA,mEAIA,eAIoB,EAApB,mBAEA,YACkB,QAAlB,+CACkB,QAAlB,4FAdA,8CAiBI,aA5DJ,SA4DA,GAEM,QAAN,gCACM,KAAN,uCC/I+U,I,YCO3UC,EAAY,eACd,EACAb,EACAY,GACA,EACA,KACA,KACA,MAIa,aAAAC,E,8BClBfC,EAAOC,QAAU,IAA0B","file":"js/chunk-241a4b6a.45d5507c.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"login fill-height\",attrs:{\"fluid\":\"\"}},[_c('v-row',{staticClass:\"pb-12\",attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"align-self\":\"center\",\"cols\":\"12\",\"md\":\"12\"}},[(_vm.isLogin)?_c('h1',{attrs:{\"align\":\"center\"}},[_vm._v(\" Войти \")]):_c('h1',{attrs:{\"align\":\"center\"}},[_vm._v(\" Зарегистрироваться \")])]),_c('v-col',{attrs:{\"align-self\":\"center\",\"cols\":\"12\",\"sm\":\"7\",\"md\":\"4\",\"lg\":\"3\"}},[_c('v-card',{},[_c('v-card-text',{staticClass:\"pt-lg-5 cyan lighten-5\",attrs:{\"align\":\"center\",\"dark\":\"\"}},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"10\"}},[_c('v-label',[_vm._v(\" Зарегистрированные пользователи могут добавлять и просматривать детали событий. \")])],1),_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"10\"}},[_c('v-label',[_vm._v(\" Регистрация в системе производиться через мессенджер Telegram. \")])],1),_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"10\"}},[_c('v-label',[_vm._v(\" Пожалуйста, установите флажок при регистрации. \")])],1)],1)],1),_c('v-card-text',{attrs:{\"align\":\"center\"}},[_c('div',{ref:\"loginPanel\",staticStyle:{\"height\":\"40px\"}})]),_c('v-card-actions',{staticClass:\"pt-0\"},[_c('v-spacer'),_c('h4',[_vm._v(\" Если увас нет! \")]),_c('img',{attrs:{\"src\":require(\"../assets/google-play-badge.png\"),\"width\":\"120px\",\"height\":\"auto\"}}),_c('v-spacer')],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-container class=\"login fill-height\"\r\n               fluid>\r\n    <v-row class=\"pb-12\" align=\"center\" justify=\"center\">\r\n      <v-col align-self=\"center\" cols=\"12\" md=\"12\">\r\n        <h1 align=\"center\" v-if=\"isLogin\">\r\n          Войти\r\n        </h1>\r\n        <h1 align=\"center\" v-else>\r\n          Зарегистрироваться\r\n        </h1>\r\n      </v-col>\r\n      <v-col align-self=\"center\" cols=\"12\" sm=\"7\" md=\"4\" lg=\"3\">\r\n        <v-card class=\"\">\r\n          <v-card-text align=\"center\" class=\"pt-lg-5 cyan lighten-5\" dark>\r\n            <v-row align=\"center\" justify=\"center\">\r\n              <v-col cols=\"12\" md=\"10\">\r\n                <v-label>\r\n                  Зарегистрированные пользователи могут добавлять и просматривать детали событий.\r\n                </v-label>\r\n              </v-col>\r\n              <v-col cols=\"12\" md=\"10\">\r\n                <v-label>\r\n                  Регистрация в системе производиться через мессенджер Telegram.\r\n                </v-label>\r\n              </v-col>\r\n              <v-col cols=\"12\" md=\"10\">\r\n                <v-label>\r\n                  Пожалуйста, установите флажок при регистрации.\r\n                </v-label>\r\n              </v-col>\r\n            </v-row>\r\n          </v-card-text>\r\n\r\n\r\n          <v-card-text align=\"center\">\r\n            <div style=\"height: 40px\" ref=\"loginPanel\"></div>\r\n          </v-card-text>\r\n          <v-card-actions class=\"pt-0\">\r\n\r\n            <v-spacer></v-spacer>\r\n            <h4>\r\n              Если увас нет!\r\n            </h4>\r\n            <img src=\"../assets/google-play-badge.png\" width=\"120px\" height=\"auto\">\r\n            <v-spacer></v-spacer>\r\n          </v-card-actions>\r\n          <!--                    <v-card-actions>-->\r\n          <!-- <v-spacer></v-spacer>\r\n           <v-btn color=\"primary\">Login</v-btn>-->\r\n          <!--                    </v-card-actions>-->\r\n        </v-card>\r\n\r\n      </v-col>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\n    import msgs from \"../utils/messages\";\r\n    import * as authUtils from '../../src/utils/auth-utils'\r\n    import {CONSTANTS} from \"../utils/constants\";\r\n    // eslint-disable-next-line no-unused-vars\r\n\r\n    // eslint-disable-next-line no-unused-vars\r\n\r\n    export default {\r\n        name: 'Login',\r\n\r\n        data: () => ({\r\n            isLogin: false\r\n        }),\r\n        mounted() {\r\n            if (msgs[this.$route.query.message]) {\r\n                this.$message(msgs[this.$route.query.message])\r\n            }\r\n            this.createTelegramAuthScript()\r\n            this.loadData()\r\n            this.isLogin = false;\r\n        },\r\n        methods: {\r\n            loadData() {\r\n                // console.log('Login data')\r\n            },\r\n            createTelegramAuthScript() {\r\n                // create script with given params\r\n                const script = document.createElement('script')\r\n                script.async = true\r\n                script.src = 'https://telegram.org/js/telegram-widget.js?8'\r\n                script.setAttribute('data-size', 'large')\r\n\r\n                script.setAttribute('data-telegram-login', CONSTANTS.BOT_NAME)\r\n                script.setAttribute('data-onauth', 'onTelegramAuth(user)')\r\n                script.setAttribute('data-request-access', 'write')\r\n\r\n                this.$refs.loginPanel.appendChild(script)\r\n\r\n                window.onTelegramAuth = this.onTelegramAuth\r\n            },\r\n            onTelegramAuth(user) {\r\n                // console.log('onTelegramAuth')\r\n                // console.log(user)\r\n                let isValidTelegramData = authUtils.checkSignature(user)\r\n\r\n                if (isValidTelegramData) {\r\n                    if (!authUtils.tokenDateIsExpired(user.auth_date)) {\r\n                        this.saveExtUser(user)\r\n                        this.getUserFromDb(user)\r\n                    } else {\r\n                        this.$store.dispatch('LOGOUT')\r\n                    }\r\n                } else {\r\n                    this.$store.dispatch('LOGOUT')\r\n                }\r\n            },\r\n            saveExtUser(user) {\r\n                // console.log('SET_EXT_USER START')\r\n                this.$store.dispatch('SET_EXT_USER', user)\r\n                    .then(() => {\r\n                        // console.log('SET_EXT_USER END')\r\n                        this.$router.push('/?message=auth_success')\r\n                    });\r\n            },\r\n            async getUserFromDb(user) {\r\n                // console.log('getUserFromDb START')\r\n                await this.$store.dispatch('GET_USER_BY_ID_AND_UPDATE', user).then(res => {\r\n                    // console.log(res)\r\n                    // console.log('GET_USER_BY_ID_AND_UPDATE END: ' + res)\r\n\r\n                    if (res.data.result) {\r\n                        // console.log('DB_USER: ' + res.data.result.id + ' already exist')\r\n                        // console.log(res.data.result.id)\r\n                    } else {\r\n                        this.createDbUser(user)\r\n                    }\r\n                }, error => {\r\n                    console.log('GET_USER_BY_ID_AND_UPDATE -- ERROR : ' + error)\r\n                    console.error(\"Got nothing from server. Prompt user to check internet connection and try again\")\r\n                })\r\n            },\r\n            createDbUser(user) {\r\n                // console.log('No user in DB');\r\n                console.log('CREATE_DB_USER started: ')\r\n                this.$store.dispatch('CREATE_DB_USER', user)\r\n            }\r\n        }\r\n    }\r\n\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=678011d5&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/google-play-badge.14df6f33.png\";"],"sourceRoot":""}